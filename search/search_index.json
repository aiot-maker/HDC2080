{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"HDC2080 We use a module manufactured by CJMCU which is designed around the Texas Instrument HDC2080 integrated circuit. Description The HDC2080 is a digital humidity and temperature sensor with very attractive features: High accuracy Low power consumption I2C interface Programmable thresholds Data Ready / Interruput pin Powering the module - 3.3V only The integrated circuit has a supply voltage range of 1.6V to 3.6V. The module doesn\u00b4t have a voltage regulator therefore it can only be powered by 3.3V from the Raspberry Pi. Pinout SDC SLA are the I2C pins GND , VCC are the powering pins ADD , this input pin allows to select an alternative I2C bus address for the module. When disconnected or connected to GND the module will appear to the bus with 0x40 address. When this pin is connected to 3.3V the I2c address will be 0x41. INT , this output pin can be used to signal measurement available in the registers or be used to signal temperature or humidity thresholds. How to get humidity and temperature values The sensor will remain in sleep mode until a measurement is triggered. There is a set of three bits in the registers that will tell the sensor to work in auto measurements mode or wait for an I2C command to trigger a single measurement. The values of the measurement are converted from analog to digital and stored in specific registers from where you can read the values. It is possible to configure the sensor to signal in the physical interrupt pin the availability of new measurements. What is the threshold features It is possible to program the sensor to trigger an interruption when the temperature or humidity reaches a value too high or too low. These maximum and minimum values (thresholds) are configurable. There are four registers that can be programmed to store them. This feature can be useful in a number of use cases but not necessarily used in others.","title":"HDC2080"},{"location":"#hdc2080","text":"We use a module manufactured by CJMCU which is designed around the Texas Instrument HDC2080 integrated circuit.","title":"HDC2080"},{"location":"#description","text":"The HDC2080 is a digital humidity and temperature sensor with very attractive features: High accuracy Low power consumption I2C interface Programmable thresholds Data Ready / Interruput pin","title":"Description"},{"location":"#powering-the-module-33v-only","text":"The integrated circuit has a supply voltage range of 1.6V to 3.6V. The module doesn\u00b4t have a voltage regulator therefore it can only be powered by 3.3V from the Raspberry Pi.","title":"Powering the module - 3.3V only"},{"location":"#pinout","text":"SDC SLA are the I2C pins GND , VCC are the powering pins ADD , this input pin allows to select an alternative I2C bus address for the module. When disconnected or connected to GND the module will appear to the bus with 0x40 address. When this pin is connected to 3.3V the I2c address will be 0x41. INT , this output pin can be used to signal measurement available in the registers or be used to signal temperature or humidity thresholds.","title":"Pinout"},{"location":"#how-to-get-humidity-and-temperature-values","text":"The sensor will remain in sleep mode until a measurement is triggered. There is a set of three bits in the registers that will tell the sensor to work in auto measurements mode or wait for an I2C command to trigger a single measurement. The values of the measurement are converted from analog to digital and stored in specific registers from where you can read the values. It is possible to configure the sensor to signal in the physical interrupt pin the availability of new measurements.","title":"How to get humidity and temperature values"},{"location":"#what-is-the-threshold-features","text":"It is possible to program the sensor to trigger an interruption when the temperature or humidity reaches a value too high or too low. These maximum and minimum values (thresholds) are configurable. There are four registers that can be programmed to store them. This feature can be useful in a number of use cases but not necessarily used in others.","title":"What is the threshold features"},{"location":"amm/","text":"Auto measurement mode The HDC2080 sensor has two modes of operation in regards to generating and storing measurements to the registers. The auto measurement mode triggers measurements in programmable intervals. You can program the device the automatically measure temperature and humidity from a range of 5 samples per second to a slow rate of 1 sample every 2 minutes. As a side note I can\u00b4t imagine in which use case someone would need to generate temperature values every five seconds, especially for a sensor like this one which is used to sense ambient temperature. The second mode of operation is disabling the auto measurement and trigger them with I2C commands. So it is a kind of reading on demand. What is the best mode of operation ? It really depends on what you need. If you build a stand alone temperature and humidity device, lets say using the HDC2080 connected to a microcontroller and using an OLED display then surely you want to active the auto measurement. Now if you hook up the HDC2080 to a single board computer, like the Raspberry PI, and uses Node-RED to control an automation system then most likely you won\u00b4t need auto measurement. You can grab temperature and humidity data on demand. In our examples in this tutorial we will disable the auto measurement mode and trigger readings via I2C. Auto measurement can be tricky As a matter of fact there is something you will need to overcome when using the auto measurement mode. It may happen that you issue an I2C command to read the temperature and humidity registers at the exact time the HDC2080 is updating its internal registers. That can lead to wrong readings. It is not difficult to reproduce this issue. Just program the device to generate 5 samples per second and start reading the temperature and humidity registers at random. Not even the interrupt pin can help you to circumvent this issue. Apparently the HDC2080 does not have a mechanism to avoid this from happening, at least that I am aware of.","title":"Auto measurement mode"},{"location":"amm/#auto-measurement-mode","text":"The HDC2080 sensor has two modes of operation in regards to generating and storing measurements to the registers. The auto measurement mode triggers measurements in programmable intervals. You can program the device the automatically measure temperature and humidity from a range of 5 samples per second to a slow rate of 1 sample every 2 minutes. As a side note I can\u00b4t imagine in which use case someone would need to generate temperature values every five seconds, especially for a sensor like this one which is used to sense ambient temperature. The second mode of operation is disabling the auto measurement and trigger them with I2C commands. So it is a kind of reading on demand.","title":"Auto measurement mode"},{"location":"amm/#what-is-the-best-mode-of-operation","text":"It really depends on what you need. If you build a stand alone temperature and humidity device, lets say using the HDC2080 connected to a microcontroller and using an OLED display then surely you want to active the auto measurement. Now if you hook up the HDC2080 to a single board computer, like the Raspberry PI, and uses Node-RED to control an automation system then most likely you won\u00b4t need auto measurement. You can grab temperature and humidity data on demand. In our examples in this tutorial we will disable the auto measurement mode and trigger readings via I2C.","title":"What is the best mode of operation ?"},{"location":"amm/#auto-measurement-can-be-tricky","text":"As a matter of fact there is something you will need to overcome when using the auto measurement mode. It may happen that you issue an I2C command to read the temperature and humidity registers at the exact time the HDC2080 is updating its internal registers. That can lead to wrong readings. It is not difficult to reproduce this issue. Just program the device to generate 5 samples per second and start reading the temperature and humidity registers at random. Not even the interrupt pin can help you to circumvent this issue. Apparently the HDC2080 does not have a mechanism to avoid this from happening, at least that I am aware of.","title":"Auto measurement can be tricky"},{"location":"calibration/","text":"Calibration It is not necessary to calibrate the sensor as it is presumably calibrated during manufacturing. I did not have the opportunitty to check how accurate is the measurement. I lack a device that could give me precise reference temperature and humidity for comparison. Anyway, if you ever diagnose that you device is not well calibrated you have the possibility to add a fixed offset, positive or negative, to the readings. This is done with the use of two purpose specific registers available in the HDC2080.","title":"Calibration"},{"location":"calibration/#calibration","text":"It is not necessary to calibrate the sensor as it is presumably calibrated during manufacturing. I did not have the opportunitty to check how accurate is the measurement. I lack a device that could give me precise reference temperature and humidity for comparison. Anyway, if you ever diagnose that you device is not well calibrated you have the possibility to add a fixed offset, positive or negative, to the readings. This is done with the use of two purpose specific registers available in the HDC2080.","title":"Calibration"},{"location":"configurationregister/","text":"Configuration register You already know that the HDC2080 has two modes of operation in regards to reading values. The way to change the operating mode is writing to the Configuration register. In general you will only write once to this register but its good that you learn what this register can control. Heater Interrupt mode As you can see in the datasheet table for this register there are two modes for using the interrupt pin: level lensitivity and comparator. Basically these modoes determine how long the interrupt pin will keep signalling active. You can use the level sensivity mode whereby the pin will change dinamically according following the value it is tracking. Alternatively you can use it the the comparator mode where it will work like as flag that is restarted only when you read the register. This is more or less like a mailbox flag used in United States, where the postman will raise teh flag to signal you that mail arrived. Once you grab the mail you move the lever down so no one else in your house will bother going to take the mail.","title":"Configuration register"},{"location":"configurationregister/#configuration-register","text":"You already know that the HDC2080 has two modes of operation in regards to reading values. The way to change the operating mode is writing to the Configuration register. In general you will only write once to this register but its good that you learn what this register can control.","title":"Configuration register"},{"location":"configurationregister/#heater","text":"","title":"Heater"},{"location":"configurationregister/#interrupt-mode","text":"As you can see in the datasheet table for this register there are two modes for using the interrupt pin: level lensitivity and comparator. Basically these modoes determine how long the interrupt pin will keep signalling active. You can use the level sensivity mode whereby the pin will change dinamically according following the value it is tracking. Alternatively you can use it the the comparator mode where it will work like as flag that is restarted only when you read the register. This is more or less like a mailbox flag used in United States, where the postman will raise teh flag to signal you that mail arrived. Once you grab the mail you move the lever down so no one else in your house will bother going to take the mail.","title":"Interrupt mode"},{"location":"interruptconfiguration/","text":"Interrupt register Here is another register quickly mentioned but important. In general (but not necessarily) this register is configured only once. This register will determine which value the interrupt pin will track. In our case, as we want to track new temperature and humidity values, we will use it as data ready pin. You can however use it to signal humidity and temperatue thresholds. Some restrictions apply to the use of the interrupt pin. It can only be assigned to one measurement or threshold. it can not, for instance, signal temperature threshold exceeeded and at the same time be used to signal humidity threshold.","title":"Interrupt register"},{"location":"interruptconfiguration/#interrupt-register","text":"Here is another register quickly mentioned but important. In general (but not necessarily) this register is configured only once. This register will determine which value the interrupt pin will track. In our case, as we want to track new temperature and humidity values, we will use it as data ready pin. You can however use it to signal humidity and temperatue thresholds. Some restrictions apply to the use of the interrupt pin. It can only be assigned to one measurement or threshold. it can not, for instance, signal temperature threshold exceeeded and at the same time be used to signal humidity threshold.","title":"Interrupt register"},{"location":"measurementregister/","text":"Measurement register I will only briefly mention this register but it is crucial for this tutorial. There is one bit in this register that will trigger a measurement via I2C when it is set to value one. We will configure later a Node-RED node to set this bit whenever we want to force the HDC2080 to generate and store a new measurement. Note that this register allows also to configure the resolution of our measurements but we will not touch this configuration as we always want to work with the most precise resolution of 14 bits. This is as simple as writing the value 0x01 to the register.","title":"Measurement register"},{"location":"measurementregister/#measurement-register","text":"I will only briefly mention this register but it is crucial for this tutorial. There is one bit in this register that will trigger a measurement via I2C when it is set to value one. We will configure later a Node-RED node to set this bit whenever we want to force the HDC2080 to generate and store a new measurement. Note that this register allows also to configure the resolution of our measurements but we will not touch this configuration as we always want to work with the most precise resolution of 14 bits. This is as simple as writing the value 0x01 to the register.","title":"Measurement register"},{"location":"nodered/","text":"I2C-bus library The library i2c-bus available in NPM will empower us to read and write to the registers of the HDC2080. Using Node.js libraries is easier then ever. As from Node-RED 1.3 it is possible to require a Node.js library from inside a function node. All you need to do is declare the library name and the variable name in the setup tab of the function node.","title":"Node-RED"},{"location":"nodered/#i2c-bus-library","text":"The library i2c-bus available in NPM will empower us to read and write to the registers of the HDC2080. Using Node.js libraries is easier then ever. As from Node-RED 1.3 it is possible to require a Node.js library from inside a function node. All you need to do is declare the library name and the variable name in the setup tab of the function node.","title":"I2C-bus library"},{"location":"reading/","text":"Reading temperature and humidity Temperature is stored by the sensor in registers 0x00 and 0x01, being 0x00 the least significant (bits 0 to 7) whereas register 0x01 holds the most significant part of the value (bits 8 to 15). As a matter of fact only 14 bits are used but this won\u00b4t change how you read the value. As the value is stored in two 8-byte registers you have a couple of alternatives to get it. First alternative is to perform two consecutive byte readings. First read the register 0x00 and then read register 0x01. The other alternative is reading the value in a single shot as a 16 bit word. Whatever is the way you get the value it is necessary to apply a formula to translate it to degrees centigrade. In JavaScript this formula can be written as below if you read the registers as byte values: msg.payload = (((256 * r2) + r1) / 65536) * 165 - 40.5; where r1 is the reading of the least significant value and r2 the reading of the most significant value. Now, if you read a single 16 bit value then you want to use a slightly different formula: msg.payload = (r / 65536) * 165 - 40.5; where r is the 16 bit value. It is almost the same in regards to reading humidity values but in this case you will get the values form registers 0x02 (least significant) and 0x03 (most significant). The formula to apply, according to the datasheet is: In JavaScript this formula can be written as below if you read the registers as byte values: msg.payload = (((256 * r2) + r1) / 65536) * 100; where r1 is the reading of the least significant value and r2 the reading of the most significant value. Likewise, the formula for humidity when you read the registers as a 16 bit value: msg.payload = r / 65536 * 100;","title":"Reading humidity and temperature"},{"location":"reading/#reading-temperature-and-humidity","text":"Temperature is stored by the sensor in registers 0x00 and 0x01, being 0x00 the least significant (bits 0 to 7) whereas register 0x01 holds the most significant part of the value (bits 8 to 15). As a matter of fact only 14 bits are used but this won\u00b4t change how you read the value. As the value is stored in two 8-byte registers you have a couple of alternatives to get it. First alternative is to perform two consecutive byte readings. First read the register 0x00 and then read register 0x01. The other alternative is reading the value in a single shot as a 16 bit word. Whatever is the way you get the value it is necessary to apply a formula to translate it to degrees centigrade. In JavaScript this formula can be written as below if you read the registers as byte values: msg.payload = (((256 * r2) + r1) / 65536) * 165 - 40.5; where r1 is the reading of the least significant value and r2 the reading of the most significant value. Now, if you read a single 16 bit value then you want to use a slightly different formula: msg.payload = (r / 65536) * 165 - 40.5; where r is the 16 bit value. It is almost the same in regards to reading humidity values but in this case you will get the values form registers 0x02 (least significant) and 0x03 (most significant). The formula to apply, according to the datasheet is: In JavaScript this formula can be written as below if you read the registers as byte values: msg.payload = (((256 * r2) + r1) / 65536) * 100; where r1 is the reading of the least significant value and r2 the reading of the most significant value. Likewise, the formula for humidity when you read the registers as a 16 bit value: msg.payload = r / 65536 * 100;","title":"Reading temperature and humidity"},{"location":"registers/","text":"Register Map Programming and using the HDC2080 module require from us to understand the register map. Table from TI datasheet","title":"Registers"},{"location":"registers/#register-map","text":"Programming and using the HDC2080 module require from us to understand the register map. Table from TI datasheet","title":"Register Map"}]}